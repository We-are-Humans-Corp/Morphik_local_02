#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—Å–µ–≥–æ —Å—Ç–µ–∫–∞ Morphik

echo "üõë –û—Å—Ç–∞–Ω–æ–≤–∫–∞ Morphik..."
echo ""

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ UI –ø—Ä–æ—Ü–µ—Å—Å–∞
echo "üñ•Ô∏è  –û—Å—Ç–∞–Ω–æ–≤–∫–∞ UI..."
pkill -f "next-server" || echo "UI –ø—Ä–æ—Ü–µ—Å—Å –Ω–µ –Ω–∞–π–¥–µ–Ω"

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
echo "üê≥ –û—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤..."
docker compose --profile ollama down

echo ""
echo "‚úÖ –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã"
echo ""

# –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –æ—á–∏—Å—Ç–∫—É
if [ "$1" == "--clean" ]; then
    echo "üßπ –û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö..."
    docker compose --profile ollama down -v
    echo "‚úÖ –î–∞–Ω–Ω—ã–µ –æ—á–∏—â–µ–Ω—ã"
fi